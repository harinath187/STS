{% extends "base.html" %}

{% block title %}Project List{% endblock %}

{% block content %}
<div class="container-fluid">
  <div class="row">
    <!-- Sidebar -->
    <!-- <div class="col-md-2 bg-white shadow-sm p-0 position-fixed h-100">
      {% include "common/project_manager.html" %}
    </div> -->

    <!-- Main Content -->
    <div class="col-md-10 offset-md-2 pt-4 px-4">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="fw-bold mb-0">Project List</h2>
        <a href="/projects/add" class="btn btn-primary">
          <i class="bi bi-plus-circle me-1"></i> Add New Project
        </a>
      </div>

      {% if projects %}
      <div class="table-responsive">
        <table id="projectTable" class="table table-striped table-bordered align-middle">
          <thead class="table-dark">
            <tr>
              <th>ID</th>
              <th>Project Name</th>
              <th>Client ID</th>
              <th>Project Manager</th>
              <th>Duration (months)</th>
              <th>Tech Stack</th>
              <th>Actual Time Taken</th>
              <th>Cost (hours)</th>
              <th>Attachment</th>
              <th>Status</th>
              <th>Created At</th>
              <th>Updated At</th>
            </tr>
          </thead>
          <tbody>
            {% for project in projects %}
            <tr>
              <td>{{ project.id }}</td>
              <td>{{ project.project_name }}</td>
              <td>{{ project.client_id }}</td>
              <td>{{ project.project_manager }}</td>
              <td>{{ project.estimated_duration_months }}</td>
              <td>{{ project.tech_stack }}</td>
              <td>{{ project.actual_time_taken }}</td>
              <td>{{ project.cost_hours }}</td>
              <td>
                {% if project.Attachment %}
                  <a href="{{ url_for('static', filename=project.Attachment) }}" class="btn btn-sm btn-outline-primary" target="_blank">View</a>
                {% else %}
                  <span class="text-muted">No file</span>
                {% endif %}
              </td>
              <td>
                {% if project.status_percentage >= 100 %}
                  <span class="badge bg-success">Completed</span>
                {% else %}
                  <span class="badge bg-warning text-dark">Pending</span>
                {% endif %}
              </td>
              <td>{{ project.created_at }}</td>
              <td>{{ project.updated_at }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      {% else %}
        <div class="alert alert-info">No projects found.</div>
      {% endif %}
    </div>
  </div>
</div>

<!-- Scripts -->
<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script>
  $(document).ready(function() {
    $('#projectTable').DataTable({
      pageLength: 10,
      lengthMenu: [5, 10, 25, 50, 100],
      order: [[0, 'asc']],
      responsive: true,
      language: {
        search: "_INPUT_",
        searchPlaceholder: "Search projects..."
      }
    });
  });
</script>
{% endblock %}